{"version":3,"file":"vue.js","sources":["../src/util/index.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["\r\nexport function isObject(value) {\r\n    return typeof value === 'object' && value !== null\r\n}\r\n\r\n\r\nexport function def(data, key, value) {\r\n    Object.defineProperty(data, key, {\r\n        enumerable: false,\r\n        configurable: false,\r\n        value\r\n    })\r\n} ","let oldArrayMethods = Array.prototype;\r\nexport const arrayMethods = Object.create(oldArrayMethods);\r\n\r\nconst methods = [\r\n    'push',\r\n    'pop',\r\n    'unshift',\r\n    'shift',\r\n    'splice',\r\n    'reverse',\r\n    'sort'\r\n]\r\n\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function(...args) {\r\n        const result = oldArrayMethods[method].apply(this,args); // 调用原生的数组方法\r\n        let inserted; // 当前用户插入的元素\r\n        let ob = this.__ob__;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice': // 3个  新增的属性 splice 有删除 新增的的功能 arr.splice(0,1,{name:1})\r\n                inserted = args.slice(2)\r\n            default:\r\n                break;\r\n        }\r\n        if(inserted) ob.observerArray(inserted); // 将新增属性继续观测\r\n\r\n        return result;\r\n    }\r\n})","import { isObject, def} from \"../util/index.js\";\r\nimport {arrayMethods} from './array.js'\r\n\r\nclass Observer{\r\n    constructor(value) {\r\n        if(Array.isArray(value)){\r\n\r\n            // value.__ob__ = this; // 我给每一个监控过的对象都增加一个__ob__属性\r\n            def(value,'__ob__',this);\r\n            value.__proto__ = arrayMethods;\r\n            this.observerArray(value)\r\n        }else{\r\n            this.walk(value);\r\n        }\r\n    }\r\n    observerArray(data) {\r\n        data.forEach(value=>{\r\n            observe(value)\r\n        })\r\n    }\r\n    walk(data) {\r\n        let keys = Object.keys(data);\r\n        keys.forEach(key=>{\r\n            defineReactive(data, key, data[key])\r\n        })\r\n        \r\n    }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n    observe(value)\r\n    Object.defineProperty(data, key,{\r\n        get() {\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if(newValue === value) return;\r\n            value = newValue\r\n            observe(value)\r\n        }\r\n    }) \r\n}\r\n\r\nexport function observe(data) {\r\n    let isObj = isObject(data);\r\n    if(!isObj) return\r\n\r\n    new Observer(data);\r\n}","import {observe} from './observer/index.js'\r\nexport function initState(vm){\r\n    const opts = vm.$options;\r\n    //vue 数据来源 props 、 methods 、data、computed、watch\r\n    if(opts.props) {\r\n        initProps(vm);\r\n    }\r\n    if(opts.methods) {\r\n        intiMethods(vm);\r\n    }\r\n    if(opts.data) {\r\n        initData(vm);\r\n    }\r\n    if(opts.computed) {\r\n        initComputed(vm);\r\n    }\r\n    if(opts.watch) {\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initProps() {}\r\nfunction intiMethods() {}\r\n\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm._data = typeof data === 'function' ? data() : data;\r\n    \r\n    //数据劫持\r\n    observe(data);\r\n}\r\n\r\n\r\nfunction initComputed() {}\r\nfunction initWatch() {}","\r\nimport {initState} from \"./state\"\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function(options) {\r\n        \r\n        //数据劫持\r\n        const vm = this;\r\n        vm.$options = options;//将配置信息挂载在实例上\r\n        initState(vm)\r\n    }\r\n}","import {initMixin} from \"./init\"\r\nfunction Vue(options) {\r\n    //vue初始化\r\n    this._init(options);\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\n\r\n\r\nexport default Vue;"],"names":["isObject","value","def","data","key","Object","defineProperty","enumerable","configurable","oldArrayMethods","Array","prototype","arrayMethods","create","methods","forEach","method","args","result","apply","inserted","ob","__ob__","slice","observerArray","Observer","isArray","__proto__","walk","observe","keys","defineReactive","get","set","newValue","isObj","initState","vm","opts","$options","props","initData","computed","watch","_data","initMixin","Vue","_init","options"],"mappings":"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"}