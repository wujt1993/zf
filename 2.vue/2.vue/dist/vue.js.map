{"version":3,"file":"vue.js","sources":["../src/complier/generate.js","../src/complier/parse.js","../src/complier/index.js","../src/observer/dep.js","../src/util.js","../src/observer/schedular.js","../src/observer/watcher.js","../src/vdom/patch.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/index.js"],"sourcesContent":["const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\r\n\r\nfunction genProps(attrs) {\r\n    let str = '';\r\n    for(let i = 0; i < attrs.length; i++) {\r\n        let attr = attrs[i];\r\n        if(attr.name==\"style\") {\r\n            let obj = {};\r\n            attr.value.split(';').forEach(item => {\r\n                if(item) {\r\n                    let [key, value] = item.split(':');\r\n                    obj[key] = value\r\n                }\r\n            });\r\n            attr.value = obj\r\n        }\r\n\r\n        str += `${attr.name}:${JSON.stringify(attr.value)},`\r\n    }\r\n    return `{${str.slice(0,-1)}}`\r\n}\r\nfunction gen(node) {\r\n    if(node.type == 1) {\r\n        return generate(node)\r\n    }else {\r\n        let text = node.text;\r\n        if(defaultTagRE.test(text)) {\r\n            let tokens = [];\r\n            let match ;\r\n            let index = 0;\r\n            let lastIndex = defaultTagRE.lastIndex = 0;\r\n            while(match = defaultTagRE.exec(text)){ // aa {{ age }} haha \r\n                index = match.index;\r\n                if(index >lastIndex){\r\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`);\r\n                lastIndex = index + match[0].length;\r\n            }\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return  `_v(${tokens.join('+')})`\r\n        }else {\r\n            return `_v(${JSON.stringify(text)})`\r\n        }\r\n    }\r\n}\r\n\r\nfunction genChildren(el) {\r\n    const children  = el.children;\r\n    if(children){\r\n        return children.map(child=>gen(child)).join(',')\r\n    }\r\n}\r\nexport function generate(el) {\r\n    let children = genChildren(el);\r\n    let code = `_c('${el.tag}',${el.attrs.length!=0?genProps(el.attrs):'undefined'}${children?','+children:''})`;\r\n    return code;   \r\n}\r\n\r\n/**\r\n * 将字符串 转成可运行的js\r\n * <div id=\"app\" a=1 b =\"2\">\r\n *    hello \r\n *    <div style=\"color: red\">\r\n *         <span>! {{ name}} !</span>\r\n *    </div>\r\n * </div>\r\n * _c('div',{id:'app',a:1,b:'2'},\r\n *      _v(\"hello\"),\r\n *      _c('div', {style:{color: 'red}}, \r\n *          _c('span',undefined, \r\n *              _v('!' + _s(name) + '!')\r\n *          )\r\n *      )\r\n * )\r\n */","\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aa \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 可以匹配到标签名  [1]\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //[0] 标签的结束名字\r\n//    style=\"xxx\"   style='xxx'  style=xxx\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\n\r\n\r\nexport function parseHTML(html) {\r\n    let root;\r\n    let currentParent;\r\n    let stack = []\r\n\r\n\r\n    function createASTElement(tag, attrs) {\r\n        return {\r\n            tag,\r\n            attrs,\r\n            type: 1,\r\n            children: [],\r\n            parent: null\r\n        }\r\n\r\n    }\r\n\r\n\r\n    function start(tagName, attrs) {\r\n        let node = createASTElement(tagName, attrs);\r\n        if(root == null) {\r\n            root = node;\r\n        }\r\n        currentParent = node;\r\n        stack.push(node);\r\n    }\r\n\r\n    function end(tagName) {\r\n        let node = stack.pop();\r\n        if(node.tag != tagName) {\r\n            throw Error(\"解析报错\");\r\n        }\r\n\r\n        currentParent = stack[stack.length - 1];\r\n        if(currentParent) {\r\n            node.parent = currentParent;\r\n            currentParent.children.push(node);\r\n        }\r\n    }\r\n\r\n    function chars(text) {\r\n        text = text.replace(/\\s/g,\"\");\r\n        if(text) {\r\n            currentParent.children.push({\r\n                text,\r\n                type: 3\r\n            })\r\n        }\r\n    }\r\n\r\n    function advance(n) {\r\n        html = html.substring(n)\r\n    }\r\n\r\n    function parseStartTag() {\r\n        let start = html.match(startTagOpen);\r\n        if(start) {\r\n            let match = {\r\n                tagName: start[1],\r\n                attrs: []\r\n            }\r\n            advance(start[0].length);\r\n\r\n            let end, attr;\r\n            while(!(end=html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                match.attrs.push({\r\n                    name: attr[1],\r\n                    value: attr[3] || attr[4] || attr[5] || true\r\n                })\r\n                advance(attr[0].length)\r\n            }\r\n            if(end) {\r\n                advance(end[0].length)\r\n                return match\r\n            }\r\n            \r\n        }\r\n\r\n    }\r\n\r\n    while(html) {\r\n        let textEnd = html.indexOf(\"<\");\r\n        if(textEnd == 0) {//标签\r\n            let startTagMatch = parseStartTag();\r\n            if(startTagMatch) {\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n                continue\r\n            }\r\n\r\n            let endTagMatch = html.match(endTag);\r\n            if(endTagMatch) {\r\n                advance(endTagMatch[0].length);\r\n                end(endTagMatch[1]);\r\n                continue;\r\n            }\r\n\r\n\r\n        }\r\n        if(textEnd > 0) {//文本\r\n            let text = html.substring(0, textEnd);\r\n            advance(text.length);\r\n            chars(text);\r\n        }\r\n    }\r\n    return root;\r\n}","import { generate } from \"./generate.js\";\r\nimport { parseHTML } from \"./parse.js\";\r\nexport function compileToFunctions(template) {\r\n    //获取ast树\r\n    let ast = parseHTML(template);\r\n    \r\n    //获得可运行的render函数\r\n    let code = generate(ast);\r\n    let render = `with(this){return ${code}}`\r\n    let fn = new Function(render);\r\n    return fn\r\n}\r\n\r\n// function a(){\r\n//     with(this) {\r\n//         console.log(b)\r\n//     }\r\n// }\r\n// a.call({b:1}) // 1","\r\nlet id = 0;\r\n\r\nclass Dep{\r\n    constructor() {\r\n        this.id = id++;\r\n        this.subs = []\r\n    }\r\n\r\n    depend() {\r\n        Dep.target.addDep(this); //让每个watcher 记住dep\r\n    }\r\n\r\n    addSub(watcher) {\r\n        this.subs.push(watcher)\r\n    }\r\n\r\n    notify() {\r\n        this.subs.forEach(watcher=>{\r\n            watcher.update()\r\n        })\r\n    }\r\n}\r\n\r\nDep.target = null;\r\n\r\nexport function pushTarget(watcher) {\r\n    Dep.target = watcher\r\n}\r\n\r\nexport function popTarget() {\r\n    Dep.target = null;\r\n}\r\n\r\n\r\nexport default Dep;","let callbacks = [];\r\nlet waiting = false;\r\n\r\nfunction flushCallbacks() {\r\n    for(let i = 0; i <callbacks.length;i++){\r\n        let callback = callbacks[i];\r\n        callback();\r\n    }\r\n    waiting = false;\r\n    callbacks = [];\r\n}\r\n\r\nexport function nextTick(cb) {\r\n    callbacks.push(cb);\r\n    if(!waiting) {\r\n        waiting = true;\r\n         // 1.promise先看支持不支持 \r\n        // 2.mutationObserver\r\n        // 3.setImmdiate\r\n        // 4.setTimeout  Vue3 next-tick就直接用了promise\r\n        return Promise.resolve().then(flushCallbacks)\r\n    }\r\n    \r\n}","import { nextTick } from \"../util\";\r\n\r\nlet has = {};\r\nlet queue = [];\r\nlet pending = false\r\nfunction flushSchedularQueue() {\r\n    for(let i = 0; i < queue.length; i++) {\r\n        let watcher = queue[i];\r\n        watcher.run();\r\n    }\r\n    has = {};\r\n    queue = [];\r\n    pending = false;\r\n}\r\nexport function queueWatcher(watcher){\r\n    let id = watcher.id;\r\n    if(!has[id]) {\r\n        has[id] = true;\r\n        queue.push(watcher);\r\n        if(!pending) {\r\n            pending = true;\r\n            nextTick(flushSchedularQueue)\r\n        }\r\n    }\r\n\r\n}","import Dep, { popTarget, pushTarget } from \"./dep\";\r\nimport { queueWatcher } from \"./schedular\";\r\n\r\nlet id = 0;\r\nclass Watcher{\r\n    constructor(vm, exprOrFn, cb, options) {\r\n        this.vm = vm;\r\n        this.cb = cb;\r\n        this.options = options;\r\n        this.id = id++;\r\n        this.getter = exprOrFn;\r\n        this.deps = [];\r\n        this.depsId = new Set();\r\n        this.get(); // 调用传入的函数， 调用了render方法， 此时会对模板中的数据进行取值\r\n    }\r\n\r\n    get() {\r\n        //当页面渲染时，注册一个watcher\r\n        pushTarget(this);\r\n        this.getter();\r\n        popTarget();\r\n    }\r\n\r\n    addDep(dep) {\r\n        let id = dep.id;\r\n        if(!this.depsId.has(id)) {\r\n            this.deps.push(dep);\r\n            this.depsId.add(id);\r\n            dep.addSub(this);\r\n        }\r\n    }\r\n\r\n    run() {\r\n        this.get()\r\n    }\r\n    update() {\r\n        queueWatcher(this);\r\n    }\r\n}\r\n\r\nexport default Watcher;","export function patch(oldVnode, vnode) {\r\n    // oldVnode 是一个真实的元素\r\n    const isRealElement = oldVnode.nodeType\r\n    if (isRealElement) {\r\n        // 初次渲染\r\n        const oldElm = oldVnode; // id=\"app\"\r\n        const parentElm = oldElm.parentNode; // body\r\n        let el = createElm(vnode);\r\n        parentElm.insertBefore(el, oldElm.nextSibling); // 将创建的节点查到原有的节点的下一个\r\n        parentElm.removeChild(oldElm);\r\n        return el; // vm.$el\r\n    } else {\r\n        // diff算法\r\n    }\r\n}\r\n\r\nfunction createElm(vnode) { // 根据虚拟节点创建真实的节点\r\n    let { tag, children, key, data, text, vm } = vnode;\r\n    if(typeof tag === 'string'){\r\n        // 可能是组件\r\n        vnode.el =  document.createElement(tag); // 用vue的指令时 可以通过vnode拿到真实dom\r\n        updateProperties(vnode);\r\n        children.forEach(child=>{ // 如果有儿子节点，就进行递归操作\r\n           vnode.el.appendChild(createElm(child))\r\n        })\r\n    }else{\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n\r\n    return vnode.el;\r\n}\r\nfunction updateProperties(vnode){\r\n    let newProps = vnode.data || {}; // 属性\r\n    let el = vnode.el; // dom元素\r\n\r\n    for(let key in newProps){\r\n        if(key == 'style'){\r\n            for(let styleName in newProps.style){\r\n                el.style[styleName] = newProps.style[styleName]\r\n            }\r\n        }else if(key === 'class'){\r\n            el.className = newProps.class\r\n        }else{\r\n            el.setAttribute(key,newProps[key]);\r\n        }\r\n    }\r\n}","import Watcher from \"./observer/watcher\"\r\nimport {patch} from './vdom/patch'\r\n\r\nexport function lifecycleMixin(Vue) {\r\n    Vue.prototype._update = function(vnode) {\r\n        const vm = this;\r\n        vm.$el = patch(vm.$el, vnode);\r\n    }\r\n}\r\n\r\n//组件挂载\r\nexport function mountComponent(vm, el) {\r\n     // 默认vue是通过watcher来进行渲染  = 渲染watcher （每一个组件都有一个渲染watcher）\r\n    let updateComponent = () => {\r\n        let vnode = vm._render();//生成虚拟节点\r\n        vm._update(vnode);//将虚拟节点转为真实节点\r\n    }\r\n\r\n    new Watcher(vm, updateComponent, () => {}, true); // updateComponent();\r\n\r\n}","let oldArrayMethods = Array.prototype;\r\n\r\nexport let arrayMethods = Object.create(Array.prototype);\r\n\r\nlet methods = [\r\n    'push',\r\n    'pop',\r\n    'unshift',\r\n    'shift',\r\n    'splice',\r\n    'reserve',\r\n    'sort'\r\n]\r\n\r\nmethods.forEach(method=> {\r\n    arrayMethods[method] = function(...args) {\r\n        let res = oldArrayMethods[method].call(this, ...args);\r\n        \r\n        let ob = this.__ob__;\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;    \r\n                break;\r\n            case 'splice':\r\n                inserted = args.slice(2)\r\n        }\r\n        // console.log(`调用了数组${method}方法`);\r\n        if(inserted) ob.observeArray(inserted);\r\n        ob.dep.notify();\r\n        return res;\r\n    }\r\n})\r\n","import { arrayMethods } from \"./array\";\r\nimport Dep from \"./dep\";\r\n\r\nclass Observer{\r\n    constructor(value) {\r\n        Object.defineProperty(value, \"__ob__\", {\r\n            configurable: false,\r\n            enumerable: false,\r\n            value: this,\r\n        })\r\n        this.dep = new Dep(); // 给数组本身和对象本身增加一个dep属性\r\n        if(Array.isArray(value)) {\r\n            //监听删除、添加、排序、反转元素的方法\r\n            Object.setPrototypeOf(value, arrayMethods)\r\n            this.observeArray(value);\r\n        }else{\r\n            this.walk(value);\r\n        }\r\n        \r\n    }\r\n\r\n    observeArray(value) {\r\n        for(let i = 0, len = value.length; i < len; i++) {\r\n            observe(value[i]);\r\n        }\r\n    }\r\n\r\n    walk(data) {\r\n        Object.keys(data).forEach(key=>{\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n}\r\nfunction dependArray(value){ // 就是让里层数组收集外层数组的依赖，这样修改里层数组也可以更新视图 \r\n    for(let i = 0 ; i < value.length;i++){\r\n        let current = value[i];\r\n        current.__ob__ && current.__ob__.dep.depend(); // 让里层的和外层收集的都是同一个watcher\r\n        if(Array.isArray(current)){\r\n            dependArray(current);\r\n        }\r\n    }\r\n}\r\n\r\nfunction defineReactive(data, key, value) {\r\n    let childOb = observe(value);\r\n    let dep = new Dep(); // 每次都会给属性创建一个dep\r\n    Object.defineProperty(data, key, {\r\n        get() {\r\n            if(Dep.target){\r\n                dep.depend();// 让这个属性自己的dep记住这个watcher，也要让watcher记住这个dep\r\n                if(childOb){ // 如果对数组取值 会将当前的watcher和数组进行关联\r\n                    childOb.dep.depend();\r\n                    if(Array.isArray(value)){\r\n                        dependArray(value);\r\n                    }\r\n                }\r\n                \r\n            }\r\n            return value\r\n        },\r\n        set(newValue) {\r\n            if(newValue === value) return;\r\n            value = newValue;\r\n            observe(newValue);\r\n            dep.notify();// 通知dep中记录的watcher让它去执行\r\n        }\r\n    })\r\n}\r\nexport function observe(data) {\r\n\r\n    if(typeof data !== 'object' || data === null) {\r\n        return\r\n    }\r\n    if(data.__ob__){ // 放置循环引用了\r\n        return;\r\n    }\r\n    return new Observer(data)\r\n}","import { observe } from \"./observer/index\";\r\n\r\nexport function initState(vm) {\r\n    const opts = vm.$options;\r\n    if(opts.data) {\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction proxy(target, source, key) {\r\n    Object.defineProperty(target, key, {\r\n        get() {\r\n            return target[source][key]\r\n        },\r\n        set(newValue) {\r\n            target[source][key] = newValue;\r\n        }\r\n    })\r\n}\r\n\r\n\r\nfunction initData(vm) {\r\n    let data = vm.$options.data;\r\n    data = vm._data = typeof data === 'function' ? data() : data;\r\n\r\n    for(let key in data) {\r\n        //将data上的数据挂载到vm上\r\n        proxy(vm, '_data', key);\r\n    }\r\n    observe(data);\r\n}\r\n\r\n","import { compileToFunctions } from \"./complier/index\";\r\nimport { mountComponent } from \"./lifecycle\";\r\nimport { initState } from \"./state\";\r\nimport { nextTick } from \"./util\";\r\n\r\n\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options) {\r\n        let vm = this;\r\n        vm.$options = options;\r\n        //初始化状态\r\n        initState(vm);\r\n\r\n        if(vm.$options.el) {//获取要渲染的模板\r\n            this.$mounted(vm.$options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$nextTick = nextTick\r\n    Vue.prototype.$mounted = function(el) {\r\n        el = document.querySelector(el);\r\n        const vm = this;\r\n        const options = vm.$options;\r\n        vm.$el = el;\r\n        // 获取render\r\n        if(!options.render) {\r\n            let template = options.template;\r\n            if(!template && el) {\r\n                template = el.outerHTML;\r\n            }\r\n            const render = compileToFunctions(template);\r\n            options.render = render\r\n        }\r\n\r\n        mountComponent(vm, el);\r\n        \r\n    }\r\n}\r\n\r\n","//创建虚拟节点\r\nexport function createElement(vm, tag, data={}, ...children){\r\n    return vnode(vm,tag,data, data.key,children, undefined)\r\n}\r\n\r\nexport function createTextVnode(vm, text) {\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\n\r\nfunction vnode(vm, tag, data, key,children, text) {\r\n    return {\r\n        vm, \r\n        tag,\r\n        data,\r\n        key,\r\n        children,\r\n        text\r\n    }\r\n}","import { createElement, createTextVnode } from \"./vdom/index\"\r\n\r\nexport function renderMixin(Vue) {\r\n    Vue.prototype._c = function(...args) {\r\n        return createElement(this, ...args);\r\n    }\r\n    Vue.prototype._v = function(text) {\r\n        return createTextVnode(this, text);\r\n    }\r\n    Vue.prototype._s = function(val) {\r\n        return val == null ? \"\" : typeof val === 'object' ? JSON.stringify(val) : val\r\n    }\r\n    Vue.prototype._render = function() {\r\n        let vm = this;\r\n        let render = vm.$options.render;\r\n        let vnode = render.call(vm);\r\n        return vnode\r\n    }\r\n}","import { initMixin } from \"./init\";\r\nimport { lifecycleMixin } from \"./lifecycle\";\r\nimport { renderMixin } from \"./render\";\r\n\r\n\r\nfunction Vue(options) {\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue);\r\nlifecycleMixin(Vue);\r\nrenderMixin(Vue);\r\n\r\nexport default Vue;"],"names":["defaultTagRE","genProps","attrs","str","i","length","attr","name","obj","value","split","forEach","item","key","JSON","stringify","slice","gen","node","type","generate","text","test","tokens","match","index","lastIndex","exec","push","trim","join","genChildren","el","children","map","child","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","root","currentParent","stack","createASTElement","parent","start","tagName","end","pop","Error","chars","replace","advance","n","substring","parseStartTag","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunctions","template","ast","render","fn","Function","id","Dep","constructor","subs","depend","target","addDep","addSub","watcher","notify","update","pushTarget","popTarget","callbacks","waiting","flushCallbacks","callback","nextTick","cb","Promise","resolve","then","has","queue","pending","flushSchedularQueue","run","queueWatcher","Watcher","vm","exprOrFn","options","getter","deps","depsId","Set","get","dep","add","patch","oldVnode","vnode","isRealElement","nodeType","oldElm","parentElm","parentNode","createElm","insertBefore","nextSibling","removeChild","data","document","createElement","updateProperties","appendChild","createTextNode","newProps","styleName","style","className","class","setAttribute","lifecycleMixin","Vue","prototype","_update","$el","mountComponent","updateComponent","_render","oldArrayMethods","Array","arrayMethods","Object","create","methods","method","args","res","call","ob","__ob__","inserted","observeArray","Observer","defineProperty","configurable","enumerable","isArray","setPrototypeOf","walk","len","observe","keys","defineReactive","dependArray","current","childOb","set","newValue","initState","opts","$options","initData","proxy","source","_data","initMixin","_init","$mounted","$nextTick","querySelector","outerHTML","undefined","createTextVnode","renderMixin","_c","_v","_s","val"],"mappings":"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"}